#!/usr/bin/bash
# mpv but a little easier

. /usr/share/ppz/bash.functions
. /usr/share/ppz/bash.functions.xorg

do_unto_others

args=(); x=1030; y=250; holdss=y
for arg; do
	 case "$arg" in
		  d) y=-1000;;
		  e) x=200;;
		  f) x=1290;;
		  m) holdss='';;
		  *)
				is_ssh_host "$arg" && {
					 as=mm
					 for a in "$@"; do
						  [ "$a" = "$arg" ] || as="$as $(printf %q "$(printf %q "$a")")"
					 done
					 exec urxvtb -pe -tabbedex -geometry 80x6+720+694 -e bash -c \
						  "exec ssh -t $arg exec $as"
				}
				args+=("$arg")
	 esac
done

set_xtitle "[mm] $*"

[ "$holdss" ] && {
	 holdss &
	 trap "kill -SIGHUP $!" EXIT HUP QUIT INT TERM ABRT
}

ionice -c 2 -n 0 nice -n -5 mpv --geometry=${x}:${y} -fs --ao=alsa --no-lirc \
	 --alang=en --slang=en \
	 --stop-screensaver --msglevel=all=1:statusline=9:cache=5:network=5 \
	 --cache-default=20480 --cache-min=1 --no-input-default-bindings \
	 --input-conf=/usr/share/ppz/mplayer.input.conf "${args[@]}"

echo

# leftover for pretty-printing statusline
# -msglevel all=5:statusline=9 2>&1 | nice -n -28 tr "\r" "\n" | \
# nice -n -28 awk -f ~/bin# /mawk -v qfilename="$MF" '
