#!/bin/bash

croak() {
	 echo "ERROR: $@"
	 exit
	 return 1
}

[ "$1" ] || croak USAGE: ./package-this [repo-directory]

REPO="$1"

[ -d ${REPO} ] || croak ${REPO} not mounted!

makepkg \
	 && PF=$(ls -1tr *.pkg.tar.xz | tail -n 1) \
	 && mv $PF ${REPO}/ \
	 && repo-add ${REPO}/hir.db.tar.gz ${REPO}/$PF
